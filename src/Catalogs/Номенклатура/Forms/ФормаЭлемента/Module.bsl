
&НаКлиенте
Процедура ОсновнаяЕдиницаИзмеренияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
СтандартнаяОбработка = Ложь;    
Результат = ОткрытьФормуМодально("Справочник.ОсновныеЕдиницыИзмерений.ФормаВыбора",Новый Структура("Владелец", Объект.Ссылка));
	Если Результат <> Неопределено Тогда
	Объект.ОсновнаяЕдиницаИзмерения = Результат;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
ВыбСтатус = РегистрыСведений.СтатусыМПЗ.ПолучитьПоследнее(ТекущаяДата(),Новый Структура("МПЗ",Объект.Ссылка));
Статус = ВыбСтатус.Статус;
КонецПроцедуры

&НаСервере
Процедура ПослеЗаписиНаСервере(ТекущийОбъект, ПараметрыЗаписи)
ВыбСтатус = РегистрыСведений.СтатусыМПЗ.ПолучитьПоследнее(ТекущаяДата(),Новый Структура("МПЗ",Объект.Ссылка));
	Если Статус <> ВыбСтатус.Статус Тогда
	НовыйСтатус = РегистрыСведений.СтатусыМПЗ.СоздатьМенеджерЗаписи();
	НовыйСтатус.Период = ТекущаяДата();
	НовыйСтатус.МПЗ = Объект.Ссылка;
	НовыйСтатус.Статус = Статус;
	НовыйСтатус.Записать();	
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура НаименованиеПриИзменении(Элемент)
	Объект.ПолнНаименование = Объект.Наименование;
КонецПроцедуры

&НаСервере
Процедура НайтиТоварНаСервере()
Запрос = Новый Запрос;

Запрос.Текст = 
	"ВЫБРАТЬ
	|	Товары.Ссылка
	|ИЗ
	|	Справочник.Товары КАК Товары
	|ГДЕ
	|	Товары.ЭтоГруппа = ЛОЖЬ
	|	И Товары.Наименование = &Наименование";
Запрос.УстановитьПараметр("Наименование", глНаименованиеВСкобкахБезЭтапа(Объект.Наименование));
РезультатЗапроса = Запрос.Выполнить();
ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	Объект.Товар = ВыборкаДетальныеЗаписи.Ссылка;
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура НайтиТовар(Команда)
НайтиТоварНаСервере();
	Если ЗначениеЗаполнено(Объект.Товар) Тогда
	ЭтаФорма.Модифицированность = Истина;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПрисвоитьНомерНаСервере(ВыбНумератор)
Объект.Наименование = ""+ВыбНумератор.Код+"."+Формат(ВыбНумератор.СледующийНомер,"ЧЦ=6; ЧВН=; ЧГ=")+" ("+СокрЛП(Объект.Наименование)+")";
Объект.ПолнНаименование = Объект.Наименование;
НовыйНумератор = ВыбНумератор.ПолучитьОбъект();
НовыйНумератор.СледующийНомер = НовыйНумератор.СледующийНомер + 1;
НовыйНумератор.Записать();
КонецПроцедуры

&НаКлиенте
Процедура ПрисвоитьНомер(Команда)
ВыбНумератор = Неопределено;
	Если ВвестиЗначение(ВыбНумератор,"Выберите нумератор",Тип("СправочникСсылка.НумераторСпецификаций")) Тогда
	ПрисвоитьНомерНаСервере(ВыбНумератор);	
	КонецЕсли;
КонецПроцедуры
