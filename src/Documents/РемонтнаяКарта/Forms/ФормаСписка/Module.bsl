
&НаСервере
Функция РемонтИзделияНаСервере(Спецификация)
	Попытка	
	РемонтнаяКарта = Документы.РемонтнаяКарта.СоздатьДокумент();
	РемонтнаяКарта.Дата = ТекущаяДата();
	РемонтнаяКарта.ДатаНачала = ТекущаяДата();	
	РемонтнаяКарта.Подразделение = Спецификация.Линейка.Подразделение;
	РемонтнаяКарта.УстановитьНовыйНомер("ДР"+Формат(РемонтнаяКарта.Дата,"ДФ=гг")+"-");
	РемонтнаяКарта.Автор = ПараметрыСеанса.Пользователь;	
	РемонтнаяКарта.Товар = Спецификация.Товар;
	РемонтнаяКарта.Изделие = Спецификация;
	РемонтнаяКарта.Количество = 1;	
	РемонтнаяКарта.ВидРемонта = Перечисления.ВидыРемонта.Дилерский;
	РемонтнаяКарта.Линейка = Спецификация.Линейка;
	РемонтнаяКарта.Записать(РежимЗаписиДокумента.Запись);	
	Исключение
	Сообщить(ОписаниеОшибки());
	Возврат(Неопределено);
	КонецПопытки;
Возврат(РемонтнаяКарта.Ссылка);
КонецФункции

&НаКлиенте
Процедура СоздатьРК(Команда)
Изделие = Неопределено;
	Если ВвестиЗначение(Изделие,"Выберите изделие для ремонта",Тип("СправочникСсылка.Номенклатура")) Тогда	
	РемонтИзделияНаСервере(Изделие);	
	КонецЕсли; 
КонецПроцедуры
